<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Wordle Mobile</title>
    <style>
        :root {
            /* Renk Paleti (Profesyonel) */
            --color-correct: #538d4e; /* Daha soft yeşil */
            --color-present: #b59f3b; /* Daha soft sarı */
            --color-absent: #3a3a3c;
            --color-default: #121213;
            --color-text: #ffffff;
            --color-border: #3a3a3c;
            --color-key-bg: #818384;
            --color-filled-border: #565758;

            /* Güvenli Alanlar */
            --safe-bottom: env(safe-area-inset-bottom, 20px);
            --header-height: 50px;
            --keyboard-height: 200px;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--color-default);
            color: var(--color-text);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            position: fixed; /* Ekranı kilitle */
            width: 100%;
            height: 100dvh; /* Dinamik yükseklik */
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER --- */
        header {
            height: var(--header-height);
            border-bottom: 1px solid var(--color-border);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        h1 {
            font-size: 1.2rem;
            letter-spacing: 0.1rem;
            font-weight: 700;
            margin: 0;
            text-transform: uppercase;
        }

        /* Bilgi çubuğu (Header altında ince şerit) */
        .status-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            font-size: 0.75rem;
            color: #888;
            padding: 5px 0;
            border-bottom: 1px solid #222;
        }

        /* --- OYUN ALANI (Esnek) --- */
        #board-container {
            flex-grow: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
            width: 100%;
            overflow: hidden;
        }

        #game-board {
            display: grid;
            grid-gap: 5px;
            width: 100%;
            max-width: 350px; /* Tabletlerde devasa olmasın */
            /* En boy oranı dinamik olarak JS ile ayarlanacak ama default verelim */
            aspect-ratio: 5 / 6; 
        }

        .tile {
            width: 100%;
            border: 2px solid var(--color-border);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            text-transform: uppercase;
            background-color: transparent;
            transition: transform 0.1s; /* Pop efekti için */
        }

        /* Harf girilince border rengi değişsin */
        .tile[data-status="filled"] {
            border-color: var(--color-filled-border);
            animation: pop 0.1s linear;
        }

        /* Sonuç Renkleri */
        .tile[data-status="correct"] { background-color: var(--color-correct); border-color: var(--color-correct); }
        .tile[data-status="present"] { background-color: var(--color-present); border-color: var(--color-present); }
        .tile[data-status="absent"]  { background-color: var(--color-absent); border-color: var(--color-absent); }
        
        /* Animasyonlar */
        @keyframes pop { 50% { transform: scale(1.1); } }
        
        /* --- MESAJ ALANI --- */
        #message-toast {
            position: absolute;
            top: 10%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #fff;
            color: #000;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.9rem;
            z-index: 100;
            display: none;
            opacity: 0.9;
        }

        /* --- BUTON (Restart/Next) --- */
        #action-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--color-correct);
            color: white;
            padding: 15px 30px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            cursor: pointer;
            z-index: 200;
            display: none;
        }

        /* --- KLAVYE --- */
        #keyboard {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            padding: 0 8px var(--safe-bottom) 8px; /* Alt güvenli alan */
            height: auto;
        }

        .row {
            display: flex;
            width: 100%;
            margin: 0 auto 8px;
            touch-action: manipulation;
        }

        .key {
            font-family: inherit;
            font-weight: bold;
            border: 0;
            padding: 0;
            margin: 0 3px;
            height: 58px;
            border-radius: 4px;
            cursor: pointer;
            user-select: none;
            background-color: var(--color-key-bg);
            color: var(--color-text);
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            text-transform: uppercase;
            font-size: 0.85rem;
            -webkit-tap-highlight-color: transparent;
        }

        .key.large { flex: 1.5; font-size: 0.7rem; }
        
        .key[data-state="correct"] { background-color: var(--color-correct); }
        .key[data-state="present"] { background-color: var(--color-present); }
        .key[data-state="absent"]  { background-color: var(--color-absent); }

        /* Küçük ekran optimizasyonu */
        @media (max-height: 650px) {
            .tile { font-size: 1.5rem; }
            .key { height: 48px; }
            #game-board { max-width: 300px; }
        }
    </style>
</head>
<body>

    <header>
        <h1>WORDLE TR</h1>
    </header>
    
    <div class="status-bar">
        <span id="lvl-disp">LVL 1</span>
        <span id="cat-disp">HAYVAN</span>
        <span id="life-disp">4 HAK</span>
    </div>

    <div id="message-toast"></div>
    <button id="action-btn">SONRAKİ SEVİYE</button>

    <div id="board-container">
        <div id="game-board"></div>
    </div>

    <div id="keyboard"></div>

    <script>
        // --- VERİ HAVUZU (Data Cleaned) ---
        const GAME_DATA = {
            3: { category: "HAYVAN", words: ["KUS", "AYI", "ARI", "FIL", "FOK", "KAZ", "BIT", "KOC"] },
            4: { category: "ULKE", words: ["IRAN", "IRAK", "KUBA", "PERU", "SILI", "LAOS", "MALI", "FIJI", "TOGO", "GANA", "GINE"] },
            5: { category: "SEHIR", words: ["MUGLA", "IZMIR", "SINOP", "CORUM", "SIIRT", "SIVAS", "AYDIN", "BURSA", "DUZCE", "KILIS", "IGDIR", "TOKAT", "KONYA", "NIGDE", "ADANA", "HATAY"] },
            6: { category: "BITKI", words: ["AKASYA", "ANASON", "ARIOTU", "CAKSIR", "KUSOTU", "GURGEN", "CAVDAR", "HUNNAP", "ANANAS", "KAMKAT", "KAYISI", "KARPUZ", "TURUNC", "MUSKAT", "ALABAS", "PANCAR", "PIRASA", "SALGAM", "HASHAS", "KISNIS", "KIMYON", "LAHANA", "MURVER", "MAHLEP", "REZENE", "SUTOTU", "SARIOT", "SIMSIR", "CIGDEM", "DISOTU", "KAKTUS", "KIZOTU", "LEYLAK", "NERGIS", "ORKIDE", "REYHAN", "ZAKKUM", "ZAMBAK", "CELTIK", "FISTIK", "FINDIK", "HARDAL", "PIRINC", "SAFRAN", "ZEYTIN", "KAKULE", "JOJOBA", "LILYUM"] }
        };

        // --- STATE ---
        let state = {
            tour: 3,
            maxAttempts: 0,
            currentAttempt: 0,
            word: "",
            guess: "",
            gameOver: false
        };

        const board = document.getElementById("game-board");
        const keyboard = document.getElementById("keyboard");
        const actionBtn = document.getElementById("action-btn");

        // --- INIT ---
        window.onload = () => {
            initKeyboard();
            startGame(state.tour);
        };

        // Klavye Render (Standart QWERTY - İngilizce)
        function initKeyboard() {
            const layout = [
                "Q W E R T Y U I O P",
                "A S D F G H J K L",
                "ENTER Z X C V B N M DEL"
            ];

            keyboard.innerHTML = "";
            layout.forEach(rowStr => {
                const rowDiv = document.createElement("div");
                rowDiv.className = "row";
                rowStr.split(" ").forEach(key => {
                    const btn = document.createElement("button");
                    btn.className = "key";
                    btn.textContent = key === "DEL" ? "⌫" : key;
                    btn.dataset.key = key;
                    
                    if (key === "ENTER" || key === "DEL") btn.classList.add("large");
                    
                    btn.addEventListener("click", (e) => {
                        e.preventDefault();
                        handleInput(key);
                    });
                    
                    rowDiv.appendChild(btn);
                });
                keyboard.appendChild(rowDiv);
            });
        }

        // Oyun Başlatma
        function startGame(tour) {
            if (tour > 6) {
                showToast("OYUN BİTTİ! TEBRİKLER.");
                actionBtn.style.display = "none";
                return;
            }

            // State Sıfırla
            state.tour = tour;
            state.maxAttempts = tour + 1;
            state.currentAttempt = 0;
            state.guess = "";
            state.gameOver = false;
            actionBtn.style.display = "none";
            
            // Kelime Seç
            const list = GAME_DATA[tour].words;
            state.word = list[Math.floor(Math.random() * list.length)];
            console.log("Hile:", state.word);

            // UI Güncelle
            document.getElementById("lvl-disp").textContent = `LEVEL ${tour - 2}`;
            document.getElementById("cat-disp").textContent = GAME_DATA[tour].category;
            updateLives();
            resetKeyboardStyles();

            // Board Oluştur
            createBoard(tour, state.maxAttempts);
        }

        function createBoard(cols, rows) {
            board.innerHTML = "";
            board.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;
            
            for (let i = 0; i < cols * rows; i++) {
                const tile = document.createElement("div");
                tile.className = "tile";
                tile.id = `tile-${i}`;
                board.appendChild(tile);
            }
        }

        // --- MANTIK ---
        function handleInput(key) {
            if (state.gameOver) return;

            if (key === "ENTER") {
                submitGuess();
            } else if (key === "DEL") {
                if (state.guess.length > 0) {
                    state.guess = state.guess.slice(0, -1);
                    updateGrid();
                }
            } else {
                if (state.guess.length < state.tour) {
                    state.guess += key;
                    updateGrid();
                }
            }
        }

        function updateGrid() {
            const startIdx = state.currentAttempt * state.tour;
            for (let i = 0; i < state.tour; i++) {
                const tile = document.getElementById(`tile-${startIdx + i}`);
                const letter = state.guess[i] || "";
                tile.textContent = letter;
                tile.dataset.status = letter ? "filled" : "empty";
            }
        }

        function submitGuess() {
            if (state.guess.length !== state.tour) {
                showToast("Eksik Harf!");
                shakeRow();
                return;
            }

            const result = getResult(state.guess, state.word);
            colorize(result);
            updateKeyboard(state.guess, result);

            if (state.guess === state.word) {
                state.gameOver = true;
                showToast("HARİKA!", 2000);
                setupButton("SONRAKİ SEVİYE", () => startGame(state.tour + 1));
            } else {
                state.currentAttempt++;
                state.guess = "";
                updateLives();

                if (state.currentAttempt >= state.maxAttempts) {
                    state.gameOver = true;
                    showToast(state.word, 4000); // Cevabı göster
                    setupButton("TEKRAR DENE", () => startGame(state.tour));
                }
            }
        }

        function getResult(guess, target) {
            const res = Array(guess.length).fill("absent");
            const targetFreq = {};

            // Harf sayımı
            for (let char of target) targetFreq[char] = (targetFreq[char] || 0) + 1;

            // Yeşil Kontrolü
            for (let i = 0; i < guess.length; i++) {
                if (guess[i] === target[i]) {
                    res[i] = "correct";
                    targetFreq[guess[i]]--;
                }
            }

            // Sarı Kontrolü
            for (let i = 0; i < guess.length; i++) {
                if (res[i] === "absent" && targetFreq[guess[i]] > 0) {
                    res[i] = "present";
                    targetFreq[guess[i]]--;
                }
            }
            return res;
        }

        function colorize(results) {
            const startIdx = state.currentAttempt * state.tour;
            results.forEach((status, i) => {
                const tile = document.getElementById(`tile-${startIdx + i}`);
                // Animasyonlu boyama (Flip efekti simülasyonu)
                setTimeout(() => {
                    tile.dataset.status = status;
                    tile.style.backgroundColor = `var(--color-${status})`;
                    tile.style.borderColor = `var(--color-${status})`;
                }, i * 150);
            });
        }

        function updateKeyboard(guess, results) {
            guess.split("").forEach((char, i) => {
                const status = results[i];
                const key = document.querySelector(`.key[data-key="${char}"]`);
                if (!key) return;

                const currentStatus = key.dataset.state;
                // Eğer zaten yeşilse sarı yapma
                if (currentStatus === "correct") return;
                // Eğer zaten sarıysa ve yeni durum gri ise değiştirme
                if (currentStatus === "present" && status === "absent") return;

                setTimeout(() => {
                    key.dataset.state = status;
                }, state.tour * 150); // Grid boyandıktan sonra klavyeyi boya
            });
        }

        // --- YARDIMCI FONKSİYONLAR ---
        function showToast(msg, duration = 1500) {
            const t = document.getElementById("message-toast");
            t.textContent = msg;
            t.style.display = "block";
            setTimeout(() => t.style.display = "none", duration);
        }

        function setupButton(text, callback) {
            setTimeout(() => {
                actionBtn.textContent = text;
                actionBtn.style.display = "block";
                actionBtn.onclick = callback;
            }, 1000);
        }

        function updateLives() {
            document.getElementById("life-disp").textContent = `${state.maxAttempts - state.currentAttempt} HAK`;
        }

        function resetKeyboardStyles() {
            document.querySelectorAll(".key").forEach(k => {
                k.dataset.state = "";
                k.style.backgroundColor = "";
            });
        }

        function shakeRow() {
            const startIdx = state.currentAttempt * state.tour;
            for(let i=0; i<state.tour; i++) {
                const tile = document.getElementById(`tile-${startIdx+i}`);
                tile.style.transform = "translateX(5px)";
                setTimeout(() => tile.style.transform = "translateX(-5px)", 50);
                setTimeout(() => tile.style.transform = "translateX(0)", 100);
            }
        }

        // Klavye Desteği (PC için)
        document.addEventListener("keydown", (e) => {
            if (e.key === "Enter") handleInput("ENTER");
            else if (e.key === "Backspace") handleInput("DEL");
            else if (/^[a-zA-Z]$/.test(e.key)) handleInput(e.key.toUpperCase());
        });

    </script>
</body>
</html>
